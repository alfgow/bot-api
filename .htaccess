<IfModule mod_rewrite.c>
    RewriteEngine On

    # Redirect everything to index.php (front controller)
    # except existing files and directories
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.*)$ index.php [QSA,L]
</IfModule>

# Prevent directory listing
Options -Indexes

# Deny access to sensitive files
<FilesMatch "\.(env|gitignore|md|sql|js|json|lock)$">
    <IfModule mod_authz_core.c>
        Require all denied
    </IfModule>
    <IfModule !mod_authz_core.c>
        Order allow,deny
        Deny from all
    </IfModule>
</FilesMatch>

# Deny access to config.php and database.php directly
<FilesMatch "^(config|database)\.php$">
    <IfModule mod_authz_core.c>
        Require all denied
    </IfModule>
    <IfModule !mod_authz_core.c>
        Order allow,deny
        Deny from all
    </IfModule>
</FilesMatch>

# Deny access to directories that shouldn't be public
<IfModule mod_rewrite.c>
    RewriteRule ^(controllers|middleware|helpers|src|node_modules)/ - [F,L]
</IfModule>
